<Window x:Class="WindowsApp.Main"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:webview2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        xmlns:local="clr-namespace:WindowsApp"
        mc:Ignorable="d"
        Width="900" Height="600"
        WindowStyle="None"
        AllowsTransparency="False"
        Background="Transparent"
        Loaded="Window_Loaded" Closing="Window_Closing" LocationChanged="Window_LocationChanged">
    <Window.Resources>
        <!-- 标题栏按钮样式 -->
        <Style x:Key="WindowButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="25"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#11000000"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#18000000"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            CaptionHeight="25"
            ResizeBorderThickness="6"
            GlassFrameThickness="0"
            UseAeroCaptionButtons="False"/>
    </shell:WindowChrome.WindowChrome>

    <Border x:Name="OuterBorder" 
            Background="White" 
            SnapsToDevicePixels="True" 
            BorderBrush="#22000000" 
            BorderThickness="1" >
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="25"/>
                <!-- 标题栏 -->
                <RowDefinition Height="*"/>
                <!-- 内容区 -->
            </Grid.RowDefinitions>

            <!-- 自定义标题栏 -->
            <Grid Grid.Row="0" x:Name="TitleBar">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="180"/>
                </Grid.ColumnDefinitions>

                <!-- 应用图标 -->
                <Image x:Name="WindowIcon" Source="/CustomChromeDemo;component/Resources/app.ico" Width="16" Height="16" Margin="8,0,4,0" VerticalAlignment="Center" Grid.Column="0"/>
                <!-- 标题文字 -->
                <TextBlock x:Name="WindowTitle" Text="应用名称" VerticalAlignment="Center" FontSize="13" Grid.Column="1"/>
                <!-- 右上角按钮 -->
                <StackPanel Orientation="Horizontal" Grid.Column="2"
                            HorizontalAlignment="Right" VerticalAlignment="Center"
                            Margin="0,0,0,0" shell:WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button x:Name="SideBtn" Style="{StaticResource WindowButtonStyle}" ToolTip="侧边停靠">
                        <TextBlock Text="◧" FontSize="15"/>
                    </Button>
                    <Button x:Name="MinBtn" Style="{StaticResource WindowButtonStyle}" Click="MinimizeButton_Click" ToolTip="最小化">
                        <TextBlock Text="–" FontSize="15"/>
                    </Button>
                    <Button x:Name="MaxBtn" Style="{StaticResource WindowButtonStyle}" Click="MaxRestoreButton_Click" ToolTip="最大化/还原">
                        <TextBlock x:Name="MaxIcon" Text="▢" FontSize="15"/>
                    </Button>
                    <Button x:Name="CloseBtn" Style="{StaticResource WindowButtonStyle}" Click="CloseButton_Click" ToolTip="关闭">
                        <TextBlock Text="✕" FontSize="15"/>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- 内容区 -->
            <Grid Grid.Row="1" Background="White" x:Name="Content">
                <TextBlock x:Name="Tips" Text="" Visibility="Hidden"></TextBlock>
                <webview2:WebView2 x:Name="webview" Visibility="Visible"/>
            </Grid>
        </Grid>
    </Border>
</Window>
